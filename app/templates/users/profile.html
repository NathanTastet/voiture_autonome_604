{% extends "layout.html" %}

{% block content %}
<div class="container mt-5">
  <h2><i class="bi bi-person-check"></i> Profil & droits d’accès</h2>

  <div class="mt-4">
    <h5>Utilisateur connecté :</h5>
    <ul class="list-group">
      <li class="list-group-item"><strong>Nom :</strong> {{ current_user.username }}</li>
      <li class="list-group-item"><strong>Email :</strong> {{ current_user.email }}</li>
    </ul>
    <a href="{{ url_for('user.edit_profile') }}" class="btn btn-outline-primary mt-3">
      <i class="bi bi-pencil-square"></i> Modifier mes informations
    </a>
  </div>

  <div class="mt-5">
    <h5><i class="bi bi-shield-lock"></i> Permissions d’accès :</h5>
    <form>
      <div class="form-check form-switch mb-2 d-flex align-items-center justify-content-between">
        <div>
          <input class="form-check-input" type="checkbox" id="permDashboard" disabled {{ "checked" if current_user.can_access_dashboard else "" }}>
          <label class="form-check-label" for="permDashboard">Accès au Dashboard</label>
        </div>
        {% if not current_user.can_access_dashboard %}
          <a href="{{ url_for('request_access', permission='dashboard') }}" class="btn btn-sm btn-outline-secondary">Demander</a>
        {% endif %}
      </div>
      <div class="form-check form-switch mb-2 d-flex align-items-center justify-content-between">
        <div>
          <input class="form-check-input" type="checkbox" id="permPilotage" disabled {{ "checked" if current_user.can_pilot_robot else "" }}>
          <label class="form-check-label" for="permPilotage">Accès au Pilotage</label>
        </div>
        {% if not current_user.can_pilot_robot %}
          <a href="{{ url_for('request_access', permission='pilotage') }}" class="btn btn-sm btn-outline-secondary">Demander</a>
        {% endif %}
      </div>
      <div class="form-check form-switch mb-2 d-flex align-items-center justify-content-between">
        <div>
          <input class="form-check-input" type="checkbox" id="permHistorique" disabled {{ "checked" if current_user.can_view_history else "" }}>
          <label class="form-check-label" for="permHistorique">Accès à l’historique des courses</label>
        </div>
        {% if not current_user.can_view_history %}
          <a href="{{ url_for('request_access', permission='historique') }}" class="btn btn-sm btn-outline-secondary">Demander</a>
        {% endif %}
      </div>
      <div class="form-check form-switch mb-2 d-flex align-items-center justify-content-between">
        <div>
          <input class="form-check-input" type="checkbox" id="permAdmin" disabled {{ "checked" if current_user.is_admin else "" }}>
          <label class="form-check-label" for="permAdmin">Administrateur (accès à la console d'administration)</label>
        </div>
        {% if not current_user.is_admin %}
          <a href="{{ url_for('request_access', permission='admin') }}" class="btn btn-sm btn-outline-secondary">Demander</a>
        {% endif %}
      </div>
    </form>
  </div>
</div>
{% endblock %}
